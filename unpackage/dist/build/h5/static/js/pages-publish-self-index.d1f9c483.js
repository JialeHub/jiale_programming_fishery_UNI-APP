(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-self-index"],{"0841":function(e,t,i){"use strict";i.r(t);var o=i("5046"),a=i.n(o);for(var r in o)"default"!==r&&function(e){i.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},"0e20":function(e,t,i){var o=i("34f2");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=i("4f06").default;a("4bead0e6",o,!0,{sourceMap:!1,shadowMode:!1})},"0f55":function(e,t,i){"use strict";i.r(t);var o=i("5f3e"),a=i("0841");for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("1382");var n,s=i("f0c5"),l=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,"65c33167",null,!1,o["a"],n);t["default"]=l.exports},1382:function(e,t,i){"use strict";var o=i("0e20"),a=i.n(o);a.a},"34f2":function(e,t,i){var o=i("24fb");t=o(!1),t.push([e.i,'@charset "UTF-8";\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-65c33167]{background-color:#fff}.wrap[data-v-65c33167]{padding:%?24?%}.slot-btn[data-v-65c33167]{width:%?341?%;height:%?140?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:#f4f5f6;border-radius:%?10?%}.slot-btn__hover[data-v-65c33167]{background-color:#ebecee}.pre-box[data-v-65c33167]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:wrap;flex-wrap:wrap}.pre-item[data-v-65c33167]{-webkit-box-flex:0;-webkit-flex:0 0 48.5%;flex:0 0 48.5%;border-radius:%?10?%;height:%?140?%;overflow:hidden;position:relative;margin-bottom:%?20?%}.pre-item-image[data-v-65c33167]{width:100%;height:%?140?%}body.?%PAGE?%[data-v-65c33167]{background-color:#fff}',""]),e.exports=t},5046:function(e,t,i){"use strict";(function(e){var o=i("4ea4");i("4160"),i("b680"),i("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(i("5530"));i("96cf");var r=o(i("1da1")),n=o(i("ade3")),s={data:function(){var e;return e={confirmSelectFirstValue:null,locationHandle:null,sizeSelect:!1,sourceSelect:!1,action:"",selectorType:["单拖","双拖","拖虾","围网","罩网","刺网","钓具","笼壶","张网","杂渔具","潜捕","拖贝"],selector:[{value:0,label:"省流"},{value:1,label:"原图"}],selector2:[{value:0,label:"拍摄"},{value:1,label:"从手机相册选择"}]},(0,n.default)(e,"confirmSelectFirstValue",null),(0,n.default)(e,"confirmSelectFirstValue2",null),(0,n.default)(e,"sizeType",["original","compressed"]),(0,n.default)(e,"sourceType",["album","camera"]),(0,n.default)(e,"showUploadList",!1),(0,n.default)(e,"fileList",[]),(0,n.default)(e,"form",{fishingBoats:"",operatingType:null,machinePower:"",workDays:"",location:"",locationRes:"",locationResMsg:"",fileIds:"",status:!0,title:"",type:0}),(0,n.default)(e,"modalTitle",""),(0,n.default)(e,"modalShow",!1),(0,n.default)(e,"btnLoading",!1),(0,n.default)(e,"showConfirm",!0),(0,n.default)(e,"showCancel",!1),(0,n.default)(e,"rules",{workDays:[{required:!0,message:"请输入作业天数",trigger:"blur,change"}],location:[{required:!1,message:"请定位",trigger:"blur,change"}],operatingType:[{required:!0,type:"number",message:"请前往个人中心选择作业类型",trigger:"blur,change"}],fishingBoats:[{required:!0,message:"请前往个人中心设置船号",trigger:"blur,change"}],machinePower:[{required:!0,type:"number",message:"请前往个人中心设置主机功率(千瓦)",trigger:"blur,change"}]}),e},onReady:function(){this.fileList=this.$refs.uUpload.lists},mounted:function(){this.getLocation(),this.$refs.uForm.setRules(this.rules),this.action=this.$baseURL+this.$addBaseURL("/file/upload")},created:function(){var e=this;this.form.fishingBoats=this.userInfo["fishingBoats"],this.form.machinePower=this.userInfo["machinePower"],this.form.operatingType=this.userInfo["operatingType"],uni.$on("uAvatarCropper",function(){var t=(0,r.default)(regeneratorRuntime.mark((function t(i){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.avatar=i,uni.showLoading(),t.next=4,e.$api.uploadApi(i).then((function(e){return e})).catch((function(e){return e}));case 4:o=t.sent,o=JSON.parse(o),200===o.status?e.fileList.push({url:e.$baseURL+e.$addBaseURL(o.res[0]["path"]),id:o.res[0]["id"]}):(e.modalTitle="上传失败",e.modalShow=!0),uni.hideLoading();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},computed:{userInfo:function(){return this.$store.getters.user},isLogin:function(){return!this.$isEmpty(this.$store.getters.token)}},methods:{changeStatus:function(t){this.form.status=t,e.log(t)},reset:function(){this.fileList=this.$refs.uUpload.lists=[];var e=this.form.workDays;this.form={fishingBoats:"",machinePower:"",operatingType:null,workDays:"",location:"",locationRes:"",locationResMsg:"",fileIds:"",status:!0,title:"",type:0},this.form.workDays=e,this.confirmSelectFirstValue=null,this.confirmSelectFirstValue2=null,this.form.fishingBoats=this.userInfo["fishingBoats"],this.form.machinePower=this.userInfo["machinePower"],this.form.operatingType=this.userInfo["operatingType"],this.getLocation()},sizeSelectOpen:function(){this.$isEmpty(this.confirmSelectFirstValue)?this.sizeSelect=!0:this.confirmSelect(this.confirmSelectFirstValue)},sourceSelectOpen:function(){this.$isEmpty(this.confirmSelectFirstValue2)?this.sourceSelect=!0:this.confirmSelect2(this.confirmSelectFirstValue2)},confirmSelect:function(t){e.log(t),this.confirmSelectFirstValue=t,0===t[0]["value"]?(this.$refs.uUpload.sizeType=["original","compressed"],this.sizeType=["original","compressed"],this.sourceSelectOpen()):1===t[0]["value"]&&(this.$refs.uUpload.sizeType=["original"],this.sizeType=["original"],this.sourceSelectOpen())},confirmSelect2:function(t){e.log(t),this.confirmSelectFirstValue2=t,0===t[0]["value"]?(this.$refs.uUpload.sourceType=["camera"],this.sourceType=["camera"],this.$refs.uUpload.selectFile()):1===t[0]["value"]&&(this.$refs.uUpload.sourceType=["album"],this.sourceType=["album"],this.$refs.uUpload.selectFile())},chooseAvatar:function(e){this.$u.route({url:"/uview-ui/components/u-avatar-cropper/u-avatar-cropper",params:{destWidth:e,rectWidth:300,fileType:"jpg"}})},getLocation:function(){this.$isEmpty(this.locationHandle)||clearInterval(this.locationHandle),this.getLocationFun(),this.locationHandle=setInterval(this.getLocationFun,6e4)},getLocationFun:function(){var e=this;uni.getLocation({type:"wgs84",geocode:!0,success:function(t){e.form.locationRes=JSON.stringify(t["address"]),e.form.locationResMsg=(t["address"]["country"]?t["address"]["country"]:"")+(t["address"]["province"]?t["address"]["province"]:"")+(t["address"]["city"]?t["address"]["city"]:"")+(t["address"]["district"]?t["address"]["district"]:"")+(t["address"]["street"]?t["address"]["street"]:"")+(t["address"]["streetNum"]?t["address"]["streetNum"]:"")+(t["address"]["poiName"]?t["address"]["poiName"]:""),e.form.location=t.longitude.toFixed(4)+","+t.latitude.toFixed(4)}})},goLogin:function(){uni.switchTab({url:"/pages/person/index"})},submit:function(){var t=this;e.log(this.form),this.$refs.uForm.validate(function(){var i=(0,r.default)(regeneratorRuntime.mark((function i(o){var r,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!o){i.next=12;break}return uni.showLoading(),t.form.fileIds="",t.fileList.forEach((function(e,i){0!==i&&(t.form.fileIds+=","),t.form.fileIds+=t.$isEmpty(e["id"])?e["response"]["res"][0]["id"]:e["id"]})),r=(0,a.default)({},t.form),r.status=r.status?1:2,i.next=8,t.$api.postPublishApi(r).then((function(e){return e})).catch((function(e){return e}));case 8:n=i.sent,e.log(n),200===n.status?(uni.showToast({title:"提交成功"}),setTimeout((function(){uni.switchTab({url:"/pages/home/index"})}),1e3)):t.$isEmpty(n["msg"])?(t.modalTitle="发生未知错误",t.modalShow=!0):(t.modalTitle=n["msg"],t.modalShow=!0),uni.hideLoading();case 12:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())}}};t.default=s}).call(this,i("5a52")["default"])},"5f3e":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return o}));var o={uForm:i("1cd4").default,uUpload:i("8a96").default,uSelect:i("b202").default,uFormItem:i("bc43").default,uInput:i("7d67").default,uSwitch:i("b570").default,uButton:i("6012").default,uModal:i("f817").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"content",staticStyle:{padding:"20rpx"}},[i("u-form",{ref:"uForm",attrs:{model:e.form,"error-type":["toast"],"label-width":"200"}},[i("v-uni-view",{staticClass:"wrap"},[i("v-uni-view",{on:{"!click":function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.sizeSelectOpen.apply(void 0,arguments)}}},[i("u-upload",{ref:"uUpload",attrs:{"size-type":e.sizeType,"source-type":e.sourceType,action:e.action,"auto-upload":!0,"file-list":e.fileList,deletable:!1}})],1),i("u-select",{attrs:{mode:"single-column",title:"请选择上传质量",list:e.selector},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmSelect.apply(void 0,arguments)}},model:{value:e.sizeSelect,callback:function(t){e.sizeSelect=t},expression:"sizeSelect"}}),i("u-select",{attrs:{mode:"single-column",title:"请选择上传方式",list:e.selector2},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmSelect2.apply(void 0,arguments)}},model:{value:e.sourceSelect,callback:function(t){e.sourceSelect=t},expression:"sourceSelect"}})],1),i("u-form-item",{attrs:{label:"标题",prop:"title"}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"标题",trim:!0},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("u-form-item",{attrs:{label:"作业天数",prop:"workDays",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",type:"number",placeholder:"作业天数（输入数字即可）",trim:!0},model:{value:e.form.workDays,callback:function(t){e.$set(e.form,"workDays",t)},expression:"form.workDays"}})],1),i("u-form-item",{attrs:{label:"作业类型",prop:"operatingType",required:!0}},[i("u-input",{attrs:{placeholder:"请前往个人中心选择作业类型","confirm-type":"next",disabled:!0},model:{value:e.selectorType[e.form["operatingType"]],callback:function(t){e.$set(e.selectorType,e.form["operatingType"],t)},expression:"selectorType[form['operatingType']]"}})],1),i("u-form-item",{attrs:{label:"船号",prop:"fishingBoats",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"请前往个人中心设置船号",disabled:!0},model:{value:e.form.fishingBoats,callback:function(t){e.$set(e.form,"fishingBoats",t)},expression:"form.fishingBoats"}})],1),i("u-form-item",{attrs:{label:"主机功率(千瓦)",prop:"machinePower",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"请前往个人中心设置主机功率",disabled:!0},model:{value:e.form.machinePower,callback:function(t){e.$set(e.form,"machinePower",t)},expression:"form.machinePower"}})],1),i("u-form-item",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],attrs:{label:"坐标",prop:"location"}},[i("u-input",{attrs:{"confirm-type":"next",type:"text",placeholder:"点击获取位置信息",trim:!0,disabled:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getLocation.apply(void 0,arguments)}},model:{value:e.form.location,callback:function(t){e.$set(e.form,"location",t)},expression:"form.location"}})],1),i("u-form-item",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],attrs:{label:"位置",prop:"location"}},[i("u-input",{attrs:{"confirm-type":"next",type:"text",placeholder:"点击获取位置信息",trim:!0,disabled:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getLocation.apply(void 0,arguments)}},model:{value:e.form.locationResMsg,callback:function(t){e.$set(e.form,"locationResMsg",t)},expression:"form.locationResMsg"}})],1),i("u-form-item",{attrs:{label:"是否公开",prop:"status"}},[i("u-switch",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),i("v-uni-view",{staticStyle:{"margin-top":"30rpx"}},[e.isLogin?i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary",plain:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.reset.apply(void 0,arguments)}}},[e._v("清空图片")]):e._e(),e.isLogin?i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("发布")]):i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goLogin.apply(void 0,arguments)}}},[e._v("登录后发布")])],1),i("u-modal",{attrs:{"show-confirm-button":e.showConfirm,"show-cancel-button":e.showCancel,width:"500rpx",title:e.modalTitle},on:{cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.modalShow=!1}},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[i("v-uni-view",{staticStyle:{height:"50rpx",width:"10rpx"}})],1)],1)},r=[]}}]);