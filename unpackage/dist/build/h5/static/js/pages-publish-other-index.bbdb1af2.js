(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-other-index"],{"3d38":function(e,t,i){var o=i("24fb");t=o(!1),t.push([e.i,'@charset "UTF-8";\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-ed8e1bd8]{background-color:#fff}.wrap[data-v-ed8e1bd8]{padding:%?24?%}.slot-btn[data-v-ed8e1bd8]{width:%?341?%;height:%?140?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:#f4f5f6;border-radius:%?10?%}.slot-btn__hover[data-v-ed8e1bd8]{background-color:#ebecee}.pre-box[data-v-ed8e1bd8]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:wrap;flex-wrap:wrap}.pre-item[data-v-ed8e1bd8]{-webkit-box-flex:0;-webkit-flex:0 0 48.5%;flex:0 0 48.5%;border-radius:%?10?%;height:%?140?%;overflow:hidden;position:relative;margin-bottom:%?20?%}.pre-item-image[data-v-ed8e1bd8]{width:100%;height:%?140?%}body.?%PAGE?%[data-v-ed8e1bd8]{background-color:#fff}',""]),e.exports=t},"4bb5":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return o}));var o={uForm:i("1cd4").default,uUpload:i("8a96").default,uSelect:i("b202").default,uFormItem:i("bc43").default,uInput:i("7d67").default,uRadioGroup:i("9a0d").default,uRadio:i("4a73").default,uSwitch:i("b570").default,uButton:i("6012").default,uModal:i("f817").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"content",staticStyle:{padding:"20rpx"}},[i("u-form",{ref:"uForm",attrs:{model:e.form,"error-type":["toast"],"label-width":"220"}},[i("v-uni-view",{staticClass:"wrap"},[i("v-uni-view",{on:{"!click":function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.sizeSelectOpen.apply(void 0,arguments)}}},[i("u-upload",{ref:"uUpload",attrs:{"size-type":e.sizeType,"source-type":e.sourceType,action:e.action,"auto-upload":!0,"file-list":e.fileList,deletable:!1}})],1),i("u-select",{attrs:{mode:"single-column",title:"请选择上传质量",list:e.selector},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmSelect.apply(void 0,arguments)}},model:{value:e.sizeSelect,callback:function(t){e.sizeSelect=t},expression:"sizeSelect"}}),i("u-select",{attrs:{mode:"single-column",title:"请选择上传方式",list:e.selector2},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmSelect2.apply(void 0,arguments)}},model:{value:e.sourceSelect,callback:function(t){e.sourceSelect=t},expression:"sourceSelect"}})],1),i("u-form-item",{attrs:{label:"标题",prop:"title"}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"标题",trim:!0},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("u-form-item",{attrs:{label:"作业天数",prop:"workDays",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",type:"number",placeholder:"作业天数（输入数字即可）",trim:!0},model:{value:e.form.workDays,callback:function(t){e.$set(e.form,"workDays",t)},expression:"form.workDays"}})],1),i("u-form-item",{attrs:{label:"船号",prop:"fishingBoats",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"请输入船号",trim:!0},model:{value:e.form.fishingBoats,callback:function(t){e.$set(e.form,"fishingBoats",t)},expression:"form.fishingBoats"}})],1),i("u-form-item",{attrs:{label:"作业类型",prop:"operatingType",required:!0}},[i("u-radio-group",{model:{value:e.form.operatingType,callback:function(t){e.$set(e.form,"operatingType",t)},expression:"form.operatingType"}},e._l(e.selectorType,(function(t,o){return i("u-radio",{key:o,staticStyle:{width:"33%","margin-bottom":"10rpx"},attrs:{name:o}},[e._v(e._s(t))])})),1)],1),i("u-form-item",{attrs:{label:"主机功率(千瓦)",prop:"machinePower",required:!0}},[i("u-input",{attrs:{"confirm-type":"next",placeholder:"请输入主机功率",trim:!0,type:"number"},model:{value:e.form.machinePower,callback:function(t){e.$set(e.form,"machinePower",t)},expression:"form.machinePower"}})],1),i("u-form-item",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],attrs:{label:"坐标",prop:"location"}},[i("u-input",{attrs:{"confirm-type":"next",type:"text",placeholder:"点击获取位置信息",trim:!0,disabled:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getLocation.apply(void 0,arguments)}},model:{value:e.form.location,callback:function(t){e.$set(e.form,"location",t)},expression:"form.location"}})],1),i("u-form-item",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],attrs:{label:"位置",prop:"location"}},[i("u-input",{attrs:{"confirm-type":"next",type:"text",placeholder:"点击获取位置信息",trim:!0,disabled:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getLocation.apply(void 0,arguments)}},model:{value:e.form.locationResMsg,callback:function(t){e.$set(e.form,"locationResMsg",t)},expression:"form.locationResMsg"}})],1),i("u-form-item",{attrs:{label:"是否公开",prop:"status"}},[i("u-switch",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),i("v-uni-view",{staticStyle:{"margin-top":"30rpx"}},[e.isLogin?i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary",plain:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.reset.apply(void 0,arguments)}}},[e._v("清空图片")]):e._e(),e.isLogin?i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("发布")]):i("u-button",{staticStyle:{"margin-top":"40rpx"},attrs:{disable:e.btnLoading,ripple:!0,type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goLogin.apply(void 0,arguments)}}},[e._v("登录后发布")])],1),i("u-modal",{attrs:{"show-confirm-button":e.showConfirm,"show-cancel-button":e.showCancel,width:"500rpx",title:e.modalTitle},on:{cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.modalShow=!1}},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[i("v-uni-view",{staticStyle:{height:"50rpx",width:"10rpx"}})],1)],1)},r=[]},a303:function(e,t,i){"use strict";var o=i("b87a"),a=i.n(o);a.a},b87a:function(e,t,i){var o=i("3d38");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=i("4f06").default;a("4b0de67c",o,!0,{sourceMap:!1,shadowMode:!1})},be34:function(e,t,i){"use strict";i.r(t);var o=i("4bb5"),a=i("de4e");for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("a303");var n,s=i("f0c5"),l=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,"ed8e1bd8",null,!1,o["a"],n);t["default"]=l.exports},de4e:function(e,t,i){"use strict";i.r(t);var o=i("f9b4"),a=i.n(o);for(var r in o)"default"!==r&&function(e){i.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},f9b4:function(e,t,i){"use strict";(function(e){var o=i("4ea4");i("4160"),i("b680"),i("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(i("5530"));i("96cf");var r=o(i("1da1")),n={data:function(){return{locationHandle:null,sizeSelect:!1,sourceSelect:!1,action:"",selectorType:["单拖","双拖","拖虾","围网","罩网","刺网","钓具","笼壶","张网","杂渔具","潜捕","拖贝"],selector:[{value:0,label:"省流"},{value:1,label:"原图"}],selector2:[{value:0,label:"拍摄"},{value:1,label:"从手机相册选择"}],confirmSelectFirstValue:null,confirmSelectFirstValue2:null,sizeType:["original","compressed"],sourceType:["album","camera"],showUploadList:!1,fileList:[],form:{workDays:"",fishingBoats:"",operatingType:NaN,machinePower:"",location:"",locationRes:"",locationResMsg:"",fileIds:"",status:!0,title:"",type:1},modalTitle:"",modalShow:!1,btnLoading:!1,showConfirm:!0,showCancel:!1,rules:{workDays:[{required:!0,message:"请输入作业天数",trigger:"blur,change"}],location:[{required:!1,message:"请授权定位",trigger:"blur,change"}],operatingType:[{required:!0,type:"number",message:"请选择作业类型",trigger:"blur,change"}],fishingBoats:[{required:!0,message:"请输入船号",trigger:"blur,change"}],machinePower:[{required:!0,message:"请输入主机功率(千瓦)",trigger:"blur,change"}]}}},computed:{isLogin:function(){return!this.$isEmpty(this.$store.getters.token)}},onReady:function(){this.fileList=this.$refs.uUpload.lists},mounted:function(){this.getLocation(),this.$refs.uForm.setRules(this.rules),this.action=this.$baseURL+this.$addBaseURL("/file/upload")},created:function(){var e=this;uni.$on("uAvatarCropper",function(){var t=(0,r.default)(regeneratorRuntime.mark((function t(i){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.avatar=i,uni.showLoading(),t.next=4,e.$api.uploadApi(i).then((function(e){return e})).catch((function(e){return e}));case 4:o=t.sent,o=JSON.parse(o),200===o.status?e.fileList.push({url:e.$baseURL+e.$addBaseURL(o.res[0]["path"]),id:o.res[0]["id"]}):(e.modalTitle="上传失败",e.modalShow=!0),uni.hideLoading();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{reset:function(){this.fileList=this.$refs.uUpload.lists=[];var e=this.form.workDays,t=this.form.fishingBoats,i=this.form.machinePower,o=this.form.operatingType;this.form={workDays:"",fishingBoats:"",operatingType:NaN,machinePower:"",location:"",locationRes:"",locationResMsg:"",fileIds:"",status:!0,title:"",type:1},this.form.workDays=e,this.form.fishingBoats=t,this.form.machinePower=i,this.form.operatingType=o,this.confirmSelectFirstValue=null,this.confirmSelectFirstValue2=null,this.getLocation()},sizeSelectOpen:function(){this.$isEmpty(this.confirmSelectFirstValue)?this.sizeSelect=!0:this.confirmSelect(this.confirmSelectFirstValue)},sourceSelectOpen:function(){this.$isEmpty(this.confirmSelectFirstValue2)?this.sourceSelect=!0:this.confirmSelect2(this.confirmSelectFirstValue2)},confirmSelect:function(t){e.log(t),this.confirmSelectFirstValue=t,0===t[0]["value"]?(this.$refs.uUpload.sizeType=["original","compressed"],this.sizeType=["original","compressed"],this.sourceSelectOpen()):1===t[0]["value"]&&(this.$refs.uUpload.sizeType=["original"],this.sizeType=["original"],this.sourceSelectOpen())},confirmSelect2:function(t){e.log(t),this.confirmSelectFirstValue2=t,0===t[0]["value"]?(this.$refs.uUpload.sourceType=["camera"],this.sourceType=["camera"],this.$refs.uUpload.selectFile()):1===t[0]["value"]&&(this.$refs.uUpload.sourceType=["album"],this.sourceType=["album"],this.$refs.uUpload.selectFile())},chooseAvatar:function(e){this.$u.route({url:"/uview-ui/components/u-avatar-cropper/u-avatar-cropper",params:{destWidth:e,rectWidth:300,fileType:"jpg"}})},getLocation:function(){this.$isEmpty(this.locationHandle)||clearInterval(this.locationHandle),this.getLocationFun(),this.locationHandle=setInterval(this.getLocationFun,6e4)},getLocationFun:function(){var e=this;uni.getLocation({type:"wgs84",geocode:!0,success:function(t){e.form.locationRes=JSON.stringify(t["address"]),e.form.locationResMsg=(t["address"]["country"]?t["address"]["country"]:"")+(t["address"]["province"]?t["address"]["province"]:"")+(t["address"]["city"]?t["address"]["city"]:"")+(t["address"]["district"]?t["address"]["district"]:"")+(t["address"]["street"]?t["address"]["street"]:"")+(t["address"]["streetNum"]?t["address"]["streetNum"]:"")+(t["address"]["poiName"]?t["address"]["poiName"]:""),e.form.location=t.longitude.toFixed(4)+","+t.latitude.toFixed(4)}})},goLogin:function(){uni.switchTab({url:"/pages/person/index"})},submit:function(){var e=this;this.$refs.uForm.validate(function(){var t=(0,r.default)(regeneratorRuntime.mark((function t(i){var o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!i){t.next=11;break}return uni.showLoading(),e.form.fileIds="",e.fileList.forEach((function(t,i){0!==i&&(e.form.fileIds+=","),e.form.fileIds+=e.$isEmpty(t["id"])?t["response"]["res"][0]["id"]:t["id"]})),o=(0,a.default)({},e.form),o.status=o.status?1:2,t.next=8,e.$api.postPublishApi(o).then((function(e){return e})).catch((function(e){return e}));case 8:r=t.sent,200===r.status?(uni.showToast({title:"提交成功"}),setTimeout((function(){uni.switchTab({url:"/pages/home/index"})}),1e3)):e.$isEmpty(r["msg"])?(e.modalTitle="发生未知错误",e.modalShow=!0):(e.modalTitle=r["msg"],e.modalShow=!0),uni.hideLoading();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}};t.default=n}).call(this,i("5a52")["default"])}}]);